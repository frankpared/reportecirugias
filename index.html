<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Generador de Reportes de CirugÃ­a | Districorr</title>
  <link rel="icon" href="https://i.imgur.com/aA7RzTN.png" type="image/png" />
  <link rel="stylesheet" href="style.css" />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&family=Lato&display=swap" rel="stylesheet">
  <!-- LibrerÃ­as externas -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <!-- Firebase SDK (compat version para firestore() v8) -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
</head>

<body>
  <div class="container">
    <header style="margin-bottom: 30px;">
      <img src="https://i.imgur.com/aA7RzTN.png" alt="Logo Districorr" style="max-height: 90px; display: block; margin: 0 auto 15px auto;" />
      <h4 style="text-align: center; color: #0056b3; font-weight: 600;">Generador de Reportes de CirugÃ­a Districorr</h4>
    </header>

    <!-- Formulario -->
    <div class="form-group">
      <label for="formato">Formato de Texto</label>
      <select id="formato" class="form-control">
        <option value="formal">Formal</option>
        <option value="moderno">Moderno</option>
        <option value="detallado">Detallado</option>
      </select>
      <small class="ayuda-texto">Seleccione el estilo de redacciÃ³n del reporte (actualmente no cambia mucho la salida).</small>
    </div>

    <div class="form-group">
      <label for="mensajeInicio">Mensaje de Inicio</label>
      <select id="mensajeInicio" class="form-control">
        <option>Estimados, Adjunto detalles de la cirugÃ­a programada:</option>
        <option>Estimados, Informo novedades de la cirugÃ­a programada:</option>
        <option>Equipo, adjunto detalle de cirugÃ­a para logÃ­stica y coordinaciÃ³n:</option>
        <option>Buen dÃ­a, comparto informaciÃ³n de la siguiente cirugÃ­a:</option>
      </select>
      <small class="ayuda-texto">Elija cÃ³mo comenzarÃ¡ el mensaje.</small>
    </div>

    <div class="form-group">
      <label for="paciente">Paciente (*)</label>
      <input id="paciente" class="form-control" required />
      <small class="ayuda-texto">Nombre completo del paciente.</small>
      <div class="mensaje-error" id="error-paciente">Este campo es requerido.</div>
    </div>

    <div class="form-group">
      <label for="medico">MÃ©dico (*)</label>
      <input id="medico" class="form-control" list="medicosList" placeholder="Escriba o seleccione..." required />
      <datalist id="medicosList"></datalist>
      <small class="ayuda-texto">Seleccione o escriba el nombre del mÃ©dico responsable.</small>
      <div class="mensaje-error" id="error-medico">Este campo es requerido.</div>
    </div>

    <div class="form-group">
      <label for="instrumentador">Instrumentador</label>
      <input id="instrumentador" class="form-control" list="instrumentadoresList" placeholder="Escriba o seleccione..." />
      <datalist id="instrumentadoresList"></datalist>
      <small class="ayuda-texto">Nombre del instrumentador quirÃºrgico (opcional).</small>
      <!-- No tiene mensaje de error porque no es requerido -->
    </div>

    <div class="form-group">
      <label for="lugarCirugia">Lugar de CirugÃ­a (*)</label>
      <input id="lugarCirugia" class="form-control" list="lugaresList" placeholder="Escriba o seleccione..." required />
      <datalist id="lugaresList"></datalist>
      <small class="ayuda-texto">Hospital o clÃ­nica donde se realizarÃ¡ la cirugÃ­a.</small>
      <div class="mensaje-error" id="error-lugar">Este campo es requerido.</div>
    </div>

    <div class="form-group">
      <label for="fechaCirugia">Fecha de CirugÃ­a (*)</label>
      <input type="date" id="fechaCirugia" class="form-control" required />
      <small class="ayuda-texto">Fecha programada para la intervenciÃ³n.</small>
      <div class="mensaje-error" id="error-fecha">Este campo es requerido.</div>
    </div>

    <div class="form-group">
      <label for="tipoCirugia">Tipo de CirugÃ­a (*)</label>
      <input id="tipoCirugia" class="form-control" list="tiposCirugiaList" placeholder="Escriba o seleccione..." required />
      <datalist id="tiposCirugiaList"></datalist>
      <small class="ayuda-texto">DescripciÃ³n del procedimiento quirÃºrgico.</small>
      <div class="mensaje-error" id="error-tipo">Este campo es requerido.</div>
    </div>

    <div class="form-group">
      <label for="material">Material Requerido (*)</label>
      <textarea id="material" class="form-control" rows="4" placeholder="Ingrese un Ã­tem por lÃ­nea..." required></textarea>
      <small class="ayuda-texto">Lista de materiales necesarios. Un Ã­tem por lÃ­nea.</small>
      <div class="mensaje-error" id="error-material">Este campo es requerido.</div>
    </div>

    <div class="form-group">
      <label for="observaciones">Observaciones</label>
      <textarea id="observaciones" class="form-control" rows="3" placeholder="Alergias, condiciones especiales, etc."></textarea>
      <small class="ayuda-texto">Consideraciones especiales para el procedimiento (opcional).</small>
    </div>

    <div class="form-group">
      <label for="infoAdicional">InformaciÃ³n Adicional</label>
      <textarea id="infoAdicional" class="form-control" rows="3" placeholder="Contacto alternativo, prepaga, etc."></textarea>
      <small class="ayuda-texto">Otros datos relevantes para el equipo (opcional).</small>
    </div>

    <!-- Botones de AcciÃ³n -->
    <div class="text-center" style="margin-top: 30px; display: flex; flex-wrap: wrap; justify-content: center; gap: 10px;">
      <button onclick="generarTexto()" class="btn-primario">ğŸ“ Generar Texto</button>
      <button onclick="copiarTexto()" title="Copia el texto plano y guarda el reporte en la base de datos">ğŸ“‹ Copiar y Guardar</button>
      <button onclick="compartirWhatsApp()" title="Enviar el reporte vÃ­a WhatsApp">ğŸ“² Enviar WhatsApp</button>
      <button onclick="enviarPorEmail()" title="Abrir cliente de email con el reporte">âœ‰ï¸ Enviar Email</button>
      <button onclick="imprimirReporte()" title="Abrir diÃ¡logo de impresiÃ³n o guardar como PDF">ğŸ–¨ï¸ Imprimir / PDF</button>
      <button onclick="generarImagen()" title="Descargar el reporte como una imagen PNG">ğŸ–¼ï¸ Guardar Imagen</button>
      <a href="admin.html" class="btn-link" title="Ver la lista de reportes guardados">ğŸ“ Ver Reportes</a>
      <!-- <button onclick="verEstadisticas()">ğŸ“Š Ver EstadÃ­sticas</button> -->
    </div>

    <!-- Contenedor para mostrar el resultado -->
    <div id="resultado-container" style="display: none; margin-top: 30px;">
      <!-- El reporte generado se insertarÃ¡ aquÃ­ -->
    </div>

    <!-- CrÃ©ditos -->
    <small class="credit">Desarrollado por Responsable de Sistemas Franco Pared â€“ Districorr Â®</small>
  </div>

  <!-- NotificaciÃ³n Toast (inicialmente oculta) -->
  <div id="toast" class="toast-notification" style="display:none;"></div>

  <!-- Script principal de la aplicaciÃ³n -->
  <script src="script.js"></script>
</body>
</html>
